/*David M Dickens*/

function mergeSheets() {
  
  /* Retrieve the desired folder */
  var myFolder = DriveApp.getFolderById("0B0YSJnA9R3-9S0FwY2x1TEd4ekE");
  
  /* Get all spreadsheets that resided on that folder */
  var spreadSheets = myFolder.getFilesByType("application/vnd.google-apps.spreadsheet");
  
  /* Create the new spreadsheet that you store other sheets */  
  var newSpreadSheet = SpreadsheetApp.openByUrl("https://docs.google.com/spreadsheets/d/1zQHmusx0pcHz4EPYcdmrLeJarWI7LFw5fCVfYDsTL_k/edit#gid=0");
  
  for(var p =0; p < 4; p++) {
    newSpreadSheet.setActiveSheet(newSpreadSheet.getSheets()[p]);
    newSpreadSheet.getDataRange().clear();
  }
  /* Iterate over the spreadsheets over the folder */
  while(spreadSheets.hasNext()) {
    
    var sheet = spreadSheets.next();
    
    /* Open the spreadsheet */
    var spreadSheet = SpreadsheetApp.openById(sheet.getId());
  
    /* Get all its sheets */
   //for(var y in spreadSheet.getSheets()) {
      /*copy just spreadsheet one*/
    for(t=0; t < 4; t++) {
     var sheetToCopy = spreadSheet.getSheets()[t];
       newSpreadSheet.setActiveSheet(newSpreadSheet.getSheets()[t]);
  
     
     var rows = sheetToCopy.getDataRange().getValues();
     
     for (var i = 0; i < rows.length; i++) {
        // now by calling rows[i] we can get a handle on the row and we append it to the Master Sheet
        var row = rows[i];
        
        newSpreadSheet.appendRow(row);
      }
      //}  
    }
  }      
}
  
  
    
  
